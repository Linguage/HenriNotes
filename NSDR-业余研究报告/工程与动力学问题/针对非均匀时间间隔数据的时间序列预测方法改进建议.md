
# 针对非均匀时间间隔数据的时间序列预测方法改进建议

**1. 引言**

本报告旨在针对用户提出的关于修改研究方案的请求，提供方法层面的建议。用户的研究目标是对表格数据进行机器学习程序开发，以实现时间序列数据的训练和预测。该数据包含非均匀时间间隔的位置（X1）和速度（X2）数据，以及对应的响应变量（Y1，Y2）。用户已尝试使用随机森林等方法，并进行了初步的特征工程，但预测方差仍不理想，认为问题可能在于对特征的考察缺乏针对性。本报告将针对用户提出的步骤以及其他相关方法进行深入探讨，旨在提供更优的时间序列预测方案。

**2. 从非均匀数据生成均匀时间序列**

用户建议首先基于里程（X1）与速度（X2）生成时间列，通过里程的变化率与速度的比值获得时间间隔，然后累加得到时间序列。这种方法的核心思想是利用物理关系来推算时间间隔。考虑到里程的变化量除以速度可以得到时间间隔（Δt = ΔX1 / X2），这种方法在理论上是可行的，它假设速度是位移变化的主要决定因素。然而，实际数据采集过程中可能还存在其他影响时间间隔的因素，例如数据记录设备的采样频率限制或人为操作延迟等。

作为替代方案，可以考虑直接利用数据本身的时间特性。如果用户对数据采集的频率有一定的了解，例如设备的目标采样频率，那么即使实际采样时间点不完全均匀，也可以基于这个频率创建一个均匀的时间向量1。例如，如果系统在一秒内以大约 15Hz 的速率采样，那么可以使用等间隔的方式生成时间戳。`linspace` 函数在已知时间间隔的起点、终点和样本数量的情况下，也可以用于创建均匀的时间向量1。

此外，Pandas 库提供了强大的时间序列处理功能，可以直接将非均匀时间间隔的数据转换为均匀时间间隔的数据2。`resample()` 方法允许用户指定目标频率（例如，每秒、每分钟等），并对数据进行重采样。在重采样过程中，对于新增的时间点，需要进行数据插值。

直接对原始数据（X1, X2, Y1, Y2）基于一个假定的或估计的均匀时间轴进行插值也是一种有效的方法6。例如，如果数据大致按时间顺序排列，可以先估计一个平均采样频率，然后生成一个均匀的时间序列，再使用插值方法将原始数据映射到这个新的时间序列上。`interp1` 函数在 MATLAB 中可以实现这一功能6，而在 Python 中，Pandas 的 `interpolate()` 方法或 SciPy 库中的 `interp1d` 函数可以达到类似的效果。这种方法避免了显式计算每个时间间隔，直接将数据转换到均匀的时间域。

值得注意的是，将非均匀时间序列转换为均匀时间序列是后续频域分析等方法的基础。选择合适的方法取决于对数据生成过程的理解以及对时间均匀性的要求。用户提出的基于里程和速度的方法具有一定的物理意义，但可能对噪声较为敏感。而基于采样频率或直接插值的方法则更为直接和通用。建议用户可以尝试这两种方法，并比较它们在后续分析中的效果。

**3. 时间序列数据插值方法**

在将非均匀时间序列转换为均匀时间序列的过程中，插值是至关重要的一步，用于估计在均匀时间点上的数据值。用户提到了线性插值、多项式插值和样条插值等常用方法。

**线性插值**是最简单的方法，它假设在两个已知数据点之间，数据呈线性变化2。这种方法的优点是易于实现且计算速度快，但缺点是可能无法准确捕捉数据中的非线性变化，尤其是在数据波动较大或变化剧烈的情况下，可能会导致插值结果过于平滑，丢失一些细节。

**多项式插值**通过拟合一个多项式函数来逼近数据点之间的值2。与线性插值相比，多项式插值可以更好地捕捉数据中的曲线变化。然而，高阶多项式插值可能会导致龙格现象，即在数据点附近出现剧烈的震荡，尤其是在数据点分布不均匀的情况下。选择合适的多项式阶数是一个需要考虑的问题。

**样条插值**是一种分段多项式插值方法，它将数据分成若干个区间，并在每个区间内使用低阶多项式进行插值，同时保证在连接点（称为节点）处的平滑性2。样条插值结合了多项式插值能够捕捉曲线变化的优点，又避免了高阶多项式可能出现的震荡问题，因此在处理时间序列数据时通常是一个不错的选择。常见的样条插值包括线性样条、二次样条和三次样条等。

考虑到用户的数据中响应变量 Y1 存在明显的波动（例如，从 4 到 -23，再到 -45），并且速度 X2 被描述为“主动变化的”，这意味着数据中可能存在非线性变化和较为复杂的动态特性。在这种情况下，简单的线性插值可能无法充分捕捉这些变化。样条插值，特别是三次样条插值，由于其能够提供较好的平滑性和灵活性，可能更适合处理这类数据。多项式插值也可以尝试，但需要谨慎选择多项式的阶数，避免过拟合或欠拟合。

除了上述方法，还有一些其他的插值技术，例如前向填充（forward fill, `ffill`）和后向填充（backward fill, `bfill`）3，它们将缺失值填充为前一个或后一个有效值。以及使用常数值进行填充4。这些方法虽然简单，但通常适用于处理少量缺失值或在特定场景下使用，对于需要进行频域分析等后续操作的时间序列数据，这些方法可能会引入较大的误差。

建议用户在实际操作中尝试不同的插值方法，并结合后续的分析结果来评估哪种方法最适合其数据。可以考虑使用交叉验证等方法来比较不同插值方法对最终预测性能的影响。

**4. 时间序列数据的频域分析**

用户提出对 Y1 和 Y2 进行频域分析，包括快速傅里叶变换（FFT）和小波变换等方法，以提取其频域特征。全局频域特征可用于指导多尺度预测模型的训练，局部频域特征则用于进行与输入的关联性评估。

**快速傅里叶变换（FFT）** 是一种高效计算离散傅里叶变换（DFT）的算法，可以将时域信号分解成不同频率的正弦波和余弦波的叠加2。通过 FFT，可以得到信号的频谱，从而了解信号中包含哪些主要的频率成分（全局特征）。这些全局频率特征可以帮助我们理解响应变量的整体波动特性和周期性模式，从而指导多尺度预测模型的构建，例如确定模型需要关注哪些时间尺度上的信息。

**小波变换**是一种时频分析方法，与傅里叶变换不同，小波变换使用一组称为小波的基函数来分析信号，这些基函数在时间和频率上都具有局部性2。小波变换可以将信号分解成不同尺度（对应不同频率）的小波系数，并且能够提供这些频率成分在时间上的分布信息（局部特征）。这对于分析非平稳信号或信号中频率成分随时间变化的情况非常有用。用户可以利用局部频域特征来评估输入变量（X1, X2）与响应变量（Y1, Y2）在不同时间和频率上的关联性。例如，通过分析特定时间段内输入和输出的小波系数，可以发现它们之间是否存在某种特定的频率响应关系。

在进行频域分析之前，确保时间序列数据是均匀间隔的至关重要2。如果时间间隔不均匀，直接进行 FFT 或小波变换可能会导致结果失真。因此，前述的生成均匀时间序列和数据插值步骤是频域分析的基础。

用户提到全局频域特征可用于指导多尺度预测模型的训练。例如，通过 FFT 分析发现 Y1 和 Y2 存在明显的周期性成分，那么在构建预测模型时，可以考虑引入能够捕捉这些周期性的模型结构，或者将这些频率特征作为模型的输入。局部频域特征则可以帮助我们理解输入与输出之间更细致的关联性，例如，某个输入变量的特定频率成分是否在某个时间段内对输出变量的某个频率成分产生了显著影响。

建议用户在对 Y1 和 Y2 进行 FFT 分析后，观察其频谱图，识别主要的频率成分。然后，可以尝试使用小波变换，进一步分析这些频率成分随时间的变化情况。同时，也可以对输入变量 X1 和 X2 进行类似的频域分析，以便后续进行输入输出之间的关联性评估。

**5. 速度导数（加速度）与响应变量特征的相关性分析**

用户指出速度参数 X2 不具备平稳性与随机性，它是主动变化的，因此应当分析其随时间的导数（加速度）与 Y1，Y2 的特征之间的相关性。用户也提到 X2 幅值本身与响应之间也可能存在某种相关性。

计算时间序列数据的导数可以使用有限差分方法7。对于离散时间序列，可以使用前向差分、后向差分或中心差分来近似计算导数。例如，速度在时间点 _t_ 的导数（加速度）可以近似为 _(X2(t) - X2(t-1)) / (t - (t-1))_，如果时间间隔均匀，则简化为 _X2(t) - X2(t-1)_（后向差分）。中心差分通常提供更精确的近似，例如 _(X2(t+1) - X2(t-1)) / (t+1 - (t-1))_。

分析加速度与 Y1，Y2 特征之间的相关性，可以使用各种相关性分析方法，例如皮尔逊相关系数（衡量线性相关性）、斯皮尔曼相关系数（衡量单调相关性）等9。用户也可以考虑计算互相关函数，以分析加速度和响应变量在不同时间滞后下的相关性。这可以帮助发现响应变量是否滞后于加速度的变化，或者加速度的变化是否领先于响应变量的变化。

用户提到 X2 幅值本身也可能与响应之间存在相关性，这是需要验证的。可以直接计算 X2 与 Y1 和 Y2 之间的相关系数，以评估它们之间的线性或单调关系强度。

通过分析加速度和速度幅值与响应变量之间的相关性，可以更好地理解输入变量是如何影响输出变量的。如果发现加速度与某个响应变量具有很强的相关性，这表明速度的变化率对该响应变量有显著影响。如果速度幅值本身也具有相关性，则表明速度的当前值也对响应有影响。

建议用户首先计算速度 X2 的导数（加速度），可以使用中心差分方法获得更精确的估计。然后，计算加速度与 Y1 和 Y2 之间以及速度 X2 本身与 Y1 和 Y2 之间的相关系数。同时，可以尝试计算互相关函数，以考察它们之间是否存在时间滞后效应。这些分析结果将有助于后续的特征选择和模型构建。

**6. 关注数据的统计特性，尤其是某个时间段的方差**

用户提出需要关注数据的统计特性，尤其是某个时间段的方差。分析时间序列数据的统计特性，如均值、方差、标准差、自相关性等，可以帮助我们理解数据的基本分布和时间依赖性9。

方差是衡量数据波动程度的重要指标。用户特别关注某个时间段的方差，这可能是因为在某些特定的时间段内，响应变量的波动性更大，这可能与输入变量在这些时间段内的变化有关。

计算某个时间段的方差非常直接，只需要提取该时间段内的数据，然后计算其样本方差即可。用户也可以考虑使用滑动窗口的方法计算方差，即在一个固定大小的时间窗口内，随着时间的推移，计算窗口内数据的方差。这样可以得到方差随时间变化的趋势，有助于识别方差发生显著变化的特定时间段。

分析响应变量（Y1, Y2）在特定时间段内的方差，并将其与输入变量（X1, X2）在相同时间段内的统计特性（如均值、方差、变化幅度等）进行比较，可以帮助我们发现哪些输入变量的变化可能导致了响应变量波动性的增加。例如，如果发现当速度 X2 在某个时间段内出现剧烈波动时，Y1 的方差也显著增大，这可能表明速度的快速变化是导致 Y1 不稳定的一个因素。

建议用户定义一些可能感兴趣的时间段（例如，基于先验知识或初步的数据观察），然后计算这些时间段内所有变量的方差。此外，也可以尝试使用滑动窗口计算方差，观察方差随时间的变化趋势。将响应变量的方差变化与输入变量的统计特性进行对比分析，可以为特征工程提供有价值的信息。

**7. 基于相关性的特征权重设置与选择**

用户建议在完成相关性分析之后，根据相关性的大小设置训练过程中的权重，突出相关性比较大的因素，剔除掉相关性极小的因素。这是一个常见的特征选择和特征加权策略。

在机器学习模型的训练过程中，如果某些特征与目标变量的相关性较高，那么这些特征通常被认为对模型的预测更有贡献。通过赋予这些高相关性特征更高的权重，可以使模型更加关注这些重要信息，从而可能提高模型的预测性能。相反，与目标变量相关性很低的特征可能包含的有用信息较少，甚至可能引入噪声，因此可以考虑将其剔除，以降低模型的复杂性，提高训练效率和泛化能力。

用户在前面的步骤中已经进行了速度导数、速度幅值以及频域特征等与响应变量的相关性分析。在这一步，可以将所有提取的特征（包括原始变量、时间序列、频域特征、导数、统计参数等）与目标变量（Y1, Y2）进行相关性分析。可以使用皮尔逊相关系数、斯皮尔曼相关系数等方法来衡量特征与目标变量之间的相关性强度。

基于相关性分析的结果，可以采取以下策略：

- **特征加权：** 在训练模型时，可以根据特征与目标变量的相关性大小，对不同的特征赋予不同的权重。相关性越高的特征，其权重也相应越高。具体的加权方式可以根据实际情况和所使用的模型来确定。
- **特征选择：** 可以设定一个相关性阈值。相关性高于该阈值的特征被保留用于模型训练，而相关性低于该阈值的特征则被剔除。阈值的选择可以基于经验、交叉验证或其他特征选择方法。

需要注意的是，相关性并不等同于因果性，高相关性并不一定意味着该特征是预测目标变量的唯一或最佳指标。此外，某些特征可能单独来看与目标变量的相关性不高，但与其他特征组合起来可能会产生很好的预测效果。因此，在进行特征选择时，除了考虑单个特征的相关性，也需要考虑特征之间的相互作用。

建议用户对所有生成的特征进行相关性分析，并尝试基于相关性大小进行特征加权和特征选择。可以先尝试一个简单的阈值方法，例如保留与目标变量相关性绝对值大于某个值的特征。然后，可以结合模型的性能表现，逐步调整特征选择的策略。

**8. 特征参数的逆变换与积分复原**

用户提出训练输出的可能是一些特征参数（如频域参数、导数、统计参数等），需要通过逆变换、求积分等操作复原数据，形成预测数据。

这种方法的核心思想是先预测目标时间序列的一些关键特征，然后再从这些特征重构出原始的时间序列。这种方法的有效性取决于所选择的特征参数是否能够充分表征原始时间序列的信息，以及逆变换或积分等操作是否能够准确地恢复原始数据。

对于频域特征，如果模型预测的是 Y1 和 Y2 的频谱参数（例如，某些主要频率成分的幅度和相位），那么可以使用逆傅里叶变换（IFFT）将这些频域参数转换回时域信号2。类似地，如果使用的是小波变换，则需要使用逆小波变换进行重构。

如果模型预测的是速度的导数（加速度），那么要得到速度的预测值，需要对加速度进行积分。如果需要预测位置，则需要对速度再次进行积分。在离散时间序列中，积分可以通过累加来实现。例如，如果已知加速度序列 _a(t)_ 和初始速度 _v(0)_，那么在时间 _t_ 的速度可以表示为 _v(t) = v(0) + Σ a(i)_ (从 i=1 到 t)。

对于统计参数，例如方差或自相关系数，直接通过这些参数重构原始时间序列通常是不可行的，因为这些参数是对数据整体或局部统计特性的概括，丢失了原始数据的具体数值信息。

用户提出的这种方法是一种更高级的预测策略，可能在某些特定场景下非常有效，例如当目标时间序列的某些特征比原始值更容易预测时。然而，这种方法也可能引入额外的复杂性和误差来源，例如特征参数预测的误差、逆变换或积分过程中的误差等。

建议用户可以先尝试直接预测 Y1 和 Y2 的原始时间序列值。如果效果不理想，或者用户认为目标时间序列的某些特征具有更强的可预测性，那么可以考虑这种先预测特征参数再进行重构的方法。在实施这种方法时，需要仔细选择要预测的特征参数，并确保存在可靠的逆变换或积分方法能够将这些参数转换回所需的时域数据。对于频域特征，由于存在成熟的 FFT 和 IFFT 算法，这可能是一个值得首先尝试的方向。

**9. 多尺度时间序列预测模型**

用户提到全局的频域特征可用于指导多尺度预测模型的训练。多尺度模型旨在从不同时间分辨率的角度捕捉时间序列的模式2。例如，有些模式可能在较长的时间尺度上表现出来（如趋势），而有些模式则可能在较短的时间尺度上更为明显（如季节性波动或短期噪声）。

通过对数据进行频域分析，特别是 FFT，可以识别出数据中主要的频率成分。这些频率成分对应着不同的时间尺度（周期）。例如，低频成分对应着较长的时间尺度，而高频成分对应着较短的时间尺度。

利用这些全局频域特征，可以指导多尺度模型的构建。一种可能的方法是设计一个包含多个分支或多个时间步长的模型结构，每个分支或每个时间步长专注于捕捉特定时间尺度上的模式。例如，可以有一个分支处理低频信息以预测长期趋势，另一个分支处理高频信息以预测短期波动。然后，将这些不同尺度上的预测结果进行融合，得到最终的预测结果。

另一种方法是使用小波变换进行多尺度分析。小波变换可以将信号分解成不同尺度的小波系数，这些系数可以直接作为多尺度模型的输入。模型可以学习在不同的尺度上提取有用的特征，并进行预测。

用户可以考虑基于其数据的频域分析结果，设计一个合适的多尺度模型。例如，如果 FFT 分析显示 Y1 和 Y2 存在明显的低频和高频成分，那么可以尝试构建一个包含两个主要分支的模型，一个分支处理平滑后的低频数据，另一个分支处理原始的高频数据，最后将两个分支的预测结果结合起来。

**10. 结论与建议**

本报告针对用户提出的研究方案修改需求，从生成均匀时间序列、数据插值、频域分析、导数分析、统计特性分析、相关性分析、特征权重设置与选择以及多尺度模型等方面提供了详细的方法建议。

基于以上分析，建议用户可以采取以下步骤来改进其研究方案：

1. **生成均匀时间序列：** 尝试使用 Pandas 的 `resample()` 方法，并结合合适的插值方法（如三次样条插值），将非均匀时间间隔的数据转换为均匀时间间隔的数据2。同时，也可以尝试用户提出的基于里程和速度的方法，并比较两种方法在后续分析中的效果。
2. **数据插值：** 针对不同的变量（X1, X2, Y1, Y2）尝试线性插值、多项式插值和样条插值等方法，并评估其对后续分析和预测性能的影响。考虑到速度的主动变化和响应变量的波动性，建议优先考虑样条插值。
3. **频域分析：** 对均匀时间序列的 Y1 和 Y2 进行 FFT 和小波变换，提取全局和局部频率特征。利用全局频率特征指导多尺度预测模型的构建，并使用局部频域特征进行输入输出之间的关联性评估。
4. **导数分析：** 计算速度 X2 的导数（加速度），并分析其与 Y1 和 Y2 特征之间的相关性。同时，分析速度 X2 幅值本身与响应变量之间的相关性。
5. **统计特性分析：** 计算所有变量在不同时间段（包括滑动窗口和特定时间段）内的方差，分析响应变量方差与输入变量统计特性之间的关系。
6. **相关性分析与特征选择/加权：** 对所有提取的特征（包括原始变量、频域特征、导数、统计参数等）与目标变量进行相关性分析，并基于相关性大小进行特征权重设置或特征选择。
7. **模型训练与评估：** 最初可以尝试直接使用提取的特征训练随机森林或其他适合时间序列预测的模型。如果效果不佳，可以考虑用户提出的先预测特征参数再进行重构的方法，特别是针对频域特征。同时，可以探索多尺度时间序列预测模型。
8. **数据划分：** 在模型训练和评估过程中，务必将数据划分为训练集、验证集和测试集，以进行合理的模型选择和性能评估。

通过系统地实施以上步骤，并根据实际的数据和实验结果进行迭代优化，相信可以有效地改进用户的时间序列预测方案，并降低预测的方差。



#### 引用的著作

1. Create Uniform and Nonuniform Time Vectors - MathWorks, 访问时间为 三月 26, 2025， [https://www.mathworks.com/help/signal/ug/create-uniform-and-nonuniform-time-vectors.html](https://www.mathworks.com/help/signal/ug/create-uniform-and-nonuniform-time-vectors.html)
    
2. How To Resample and Interpolate Your Time Series Data With Python - MachineLearningMastery.com, 访问时间为 三月 26, 2025， [https://machinelearningmastery.com/resample-interpolate-time-series-data-python/](https://machinelearningmastery.com/resample-interpolate-time-series-data-python/)
    
3. Pandas Resample With resample() and asfreq() - DataCamp, 访问时间为 三月 26, 2025， [https://www.datacamp.com/tutorial/pandas-resample-asfreq](https://www.datacamp.com/tutorial/pandas-resample-asfreq)
    
4. Concept | Time series resampling - Dataiku Knowledge Base, 访问时间为 三月 26, 2025， [https://knowledge.dataiku.com/latest/ml-analytics/time-series/concept-resampling.html](https://knowledge.dataiku.com/latest/ml-analytics/time-series/concept-resampling.html)
    
5. Converting Irregular Intervals to Regular Intervals with Pandas - GeeksforGeeks, 访问时间为 三月 26, 2025， [https://www.geeksforgeeks.org/converting-irregular-intervals-to-regular-intervals-with-pandas/](https://www.geeksforgeeks.org/converting-irregular-intervals-to-regular-intervals-with-pandas/)
    
6. how to transform a time-serie data non uniform to uniform - MATLAB Answers - MathWorks, 访问时间为 三月 26, 2025， [https://www.mathworks.com/matlabcentral/answers/32559-how-to-transform-a-time-serie-data-non-uniform-to-uniform](https://www.mathworks.com/matlabcentral/answers/32559-how-to-transform-a-time-serie-data-non-uniform-to-uniform)
    
7. Velocity from Position | EF105 - University of Tennessee, Knoxville, 访问时间为 三月 26, 2025， [https://efcms.engr.utk.edu/ef105-2020-08/grav/labs/numerical-analysis-1/experience-spreadsheet-numeric-velocity-from-pos](https://efcms.engr.utk.edu/ef105-2020-08/grav/labs/numerical-analysis-1/experience-spreadsheet-numeric-velocity-from-pos)
    
8. Question: 3. For the following position versus time values, calculate the average velocity for each of the four-time intervals. What is the physical meaning of a negative average velocity? (8 pts) 2.23 2.08 1.98 Position (m) Time (s) 1.38 1.63 1,17 1.65 2,08 2.08 2.65 3.16 - Chegg, 访问时间为 三月 26, 2025， [https://www.chegg.com/homework-help/questions-and-answers/3-following-position-versus-time-values-calculate-average-velocity-four-time-intervals-phy-q29728839](https://www.chegg.com/homework-help/questions-and-answers/3-following-position-versus-time-values-calculate-average-velocity-four-time-intervals-phy-q29728839)
    
9. Complete Guide on Time Series Analysis in Python - Kaggle, 访问时间为 三月 26, 2025， [https://www.kaggle.com/code/prashant111/complete-guide-on-time-series-analysis-in-python](https://www.kaggle.com/code/prashant111/complete-guide-on-time-series-analysis-in-python)
    
10. How can we generate stationary and non-stationary time series data in python?, 访问时间为 三月 26, 2025， [https://stats.stackexchange.com/questions/387115/how-can-we-generate-stationary-and-non-stationary-time-series-data-in-python](https://stats.stackexchange.com/questions/387115/how-can-we-generate-stationary-and-non-stationary-time-series-data-in-python)
    

**
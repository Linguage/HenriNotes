AWS S3与Cloudflare R2的对比：价格、性能与用户体验  
  - 原文标题：Comparing AWS S3 with Cloudflare R2: Price, Performance and User Experience  
  - 链接：[https://kerkour.com/aws-s3-vs-cloudflare-r2-price-performance-user-experience](https://kerkour.com/aws-s3-vs-cloudflare-r2-price-performance-user-experience)  

- **文章类别**：博客  

---

**内容整理**：

### 文章框架

```
├── 引言
│   ├── Cloudflare R2的推出背景
│   ├── R2与AWS S3的对比目的
├── 价格对比
│   ├── R2与S3的价格模型
│   ├── 不同使用场景下的成本分析
│   │   ├── 公共资产存储与分发
│   │   ├── 数据仓库查询
│   │   └── 跨云提供商查询
│   └── 特殊场景下的价格差异
├── 性能对比
│   ├── S3的性能特点
│   ├── R2的性能特点
│   ├── 访问方式对性能的影响
│   └── 跨数据中心流量问题
├── 用户体验对比
│   ├── API管理与安全性
│   ├── R2的API兼容性问题
│   ├── R2的存储位置限制
│   └── 用户体验总结
├── 结论
│   ├── S3与R2的适用场景
│   ├── R2的优势与不足
│   └── R2未来的发展方向
└── 附录
    ├── 文章作者的书籍推荐
    └── 订阅信息
```

### 文章内容概述

#### 引言
- Cloudflare在2021年9月推出了R2对象存储服务，通过S3 API提供服务，但不收取出站流量费用，这与AWS S3的收费模式形成鲜明对比。
- 文章旨在对比R2和S3在价格、性能和用户体验方面的差异。

#### 价格对比
- **价格模型**：
  - **AWS S3**：存储费用为每GB $0.023，出站流量费用为每GB $0.09，请求费用根据操作类型不同而有所差异。
  - **Cloudflare R2**：存储费用为每GB $0.015，出站流量免费，请求费用较低且提供大量免费请求额度。
- **不同使用场景下的成本分析**：
  - **公共资产存储与分发**：R2在存储和流量成本上显著低于S3。
  - **数据仓库查询**：
    - **同区域查询**：S3和R2的成本差异较小，但R2在请求费用上更具优势。
    - **跨区域查询**：R2因免费出站流量而更具成本效益。
  - **特殊场景**：使用S3的智能分层存储时，若大部分数据不常被访问，S3可能更具成本优势。

#### 性能对比
- **S3的性能特点**：
  - S3基于硬盘存储，延迟较高，通常在30ms以上。
  - 新推出的S3 Express One Zone存储类别提供更低延迟。
- **R2的性能特点**：
  - R2基于Cloudflare Workers和Durable Objects构建，受限于单线程特性，吞吐量较低。
  - 在Open Beta阶段，R2的性能限制较为明显，但目前的具体限制未明确公开。
- **访问方式对性能的影响**：
  - 通过`r2.dev`访问时，性能优于通过`cloudflarestorage.com`的S3 API访问。
  - 前者延迟较低且更稳定，推测与R2的认证/授权层相关。
- **跨数据中心流量问题**：
  - 由于网络路径中的路由器和服务器负载，跨数据中心访问R2时延迟可能增加。

#### 用户体验对比
- **API管理与安全性**：
  - R2的API密钥管理更为简单，适合初创企业快速部署。
  - S3需要复杂的IAM策略和权限管理。
- **API兼容性问题**：
  - R2与S3 API不完全兼容，使用AWS SDK时可能需要调整。
- **存储位置限制**：
  - R2无法指定存储位置，仅提供“位置提示”，可能导致存储位置与计算实例距离较远，增加延迟。

#### 结论
- **S3与R2的适用场景**：
  - S3适用于对延迟要求极高的场景或已深度集成AWS生态的项目。
  - R2适用于大多数其他场景，尤其是对成本敏感的项目。
- **R2的优势与不足**：
  - 优势：价格更低，用户体验更好，出站流量免费。
  - 不足：性能受限，无法指定存储位置。
- **R2未来的发展方向**：
  - Cloudflare计划推出R2 Pipeline API，支持HTTP、WebSocket和Kafka端点，用于批量写入事件到R2。

#### 附录
- 文章作者推荐了自己的书籍《Cloudflare for Speed and Security》，并提供了订阅信息。

### 文章标签
#AWS ， #Cloudflare ， #对象存储 ， #性能对比 ， #用户体验 ， #成本分析
AI推理的环境影响测量与优化

  

**概述**

  

本文聚焦于Google对AI推理（Inference）过程环境影响的系统性测量与优化。AI推理指的是使用已训练的AI模型进行预测、生成文本或图像等操作。随着AI应用的普及，推理环节的能耗和环境影响日益重要。Google通过发布技术论文，首次详细披露了Gemini模型推理的能耗、碳排放和用水量，并提出了业界最全面的测量方法。数据显示，Gemini Apps文本推理的能耗和环境影响远低于外界普遍估算。Google通过软硬件协同创新，实现了推理效率的显著提升，并承诺持续推动AI的绿色发展。

  

**AI推理环境足迹的全面测量方法**

- Google提出，准确测量AI推理的环境影响，需涵盖整个系统的实际运行情况，而不仅仅是模型活跃计算时的能耗。传统测算方法往往只考虑TPU（张量处理单元）或GPU（图形处理单元）在活跃状态下的能耗，忽略了系统实际运营中的诸多关键因素，导致结果偏乐观，无法反映真实的环境足迹。
- Google的全面测量方法包括以下几个维度：

- **动态全系统能耗**：不仅统计模型活跃计算时的能耗，还考虑芯片在生产环境下的实际利用率。由于高可用性和可靠性要求，系统需预留部分闲置算力以应对流量波动或故障转移，这部分闲置芯片的能耗也需计入总能耗。
- **CPU与内存能耗**：AI模型推理不仅依赖TPU或GPU，主机CPU和内存也参与运算并消耗能量。
- **数据中心基础设施能耗**：AI推理所用IT设备只是能耗的一部分，数据中心的冷却系统、电力分配等基础设施也消耗大量能源。Google采用PUE（Power Usage Effectiveness，电源使用效率）指标衡量数据中心的能效。
- **数据中心用水量**：为降低能耗和碳排放，数据中心常用水冷技术。随着AI系统能效提升，整体用水量也随之下降。

- 以Gemini Apps文本推理为例，采用全面测量方法后，单次推理的能耗为0.24瓦时（Wh），碳排放为0.03克二氧化碳当量（gCO2e），用水量为0.26毫升（约五滴水）。而仅计算活跃TPU/GPU能耗时，能耗仅为0.10 Wh，碳排放0.02 gCO2e，用水量0.12 mL。可见，传统方法低估了实际环境影响。
- Google认为，只有将上述所有环节纳入测量，才能获得AI推理的真实环境足迹。这一方法有助于行业统一标准，推动AI能效优化。

  

**Google的AI全栈效率提升策略**

- Google的Gemini模型推理效率提升，源于其“全栈”优化策略，涵盖模型架构、算法、硬件、软件和数据中心运营等各个层面。
- **高效模型架构**：Gemini系列基于Google自研的Transformer（变换器）架构，相比此前主流语言模型架构，效率提升10-100倍。Google还采用Mixture-of-Experts（专家混合）和Hybrid Reasoning（混合推理）等结构，能根据具体请求激活模型的部分子模块，减少不必要的计算和数据传输，效率提升10-100倍。
- **高效算法与量化技术**：Google持续优化模型算法，采用如Accurate Quantized Training（AQT，精确量化训练）等方法，在不降低响应质量的前提下，显著降低推理能耗。
- **推理与服务优化**：通过Speculative Decoding（投机解码）等技术，先用小模型预测，再由大模型快速验证，减少大模型的重复计算。Distillation（蒸馏）技术则将大模型知识迁移到小模型（如Gemini Flash和Flash-Lite），实现高效推理。硬件和模型的加速也使得批量处理更高效，满足低延迟需求。
- **定制硬件设计**：Google自研TPU（张量处理单元）已迭代十余年，最新一代Ironwood（铁木）TPU能效比首代提升30倍，远超通用CPU的推理能效。Google还实现了模型与硬件的协同设计，确保软硬件最大化能效。
- **智能闲置管理**：Google的服务系统能根据需求动态调度模型，最大限度减少TPU闲置时间，避免“静态分配”造成资源浪费。
- **高效软件栈**：XLA ML编译器、Pallas内核和Pathways系统，使得JAX等高级框架能高效运行在TPU硬件上。
- **超高效数据中心**：Google数据中心平均PUE仅1.09，处于行业领先水平。
- **负责任的数据中心运营**：Google持续增加清洁能源供给，力争实现24/7碳中和（carbon-free）运营，并推动用水补偿（replenish），目标是平均补偿消耗水量的120%。冷却系统优化则结合当地水资源状况，科学选择冷却方式，减少高压力地区的用水。

  

**框架与心智模型（Framework & Mindset）**

- **系统性全流程测量**：Google强调，AI推理环境影响的测量必须覆盖从模型、硬件、软件到数据中心的全流程，不能只看单一环节。只有系统性测量，才能发现优化空间，实现整体能效提升。
- **软硬件协同优化**：高效AI推理需模型架构、算法、硬件和软件协同设计。Google通过自研TPU与模型协同迭代，最大化性能与能效。
- **动态资源调度**：推理服务系统需根据实时需求动态分配算力，减少闲置资源，提升整体利用率。
- **持续创新与责任发展**：Google认为，AI推理能效提升是长期工程，需持续投入研发。随着AI需求增长，降低单次推理的能耗和用水量是负责任AI发展的必由之路。
- **行业标准推动者**：Google通过公开测量方法和数据，推动行业统一标准，促进AI能效优化和绿色发展。

  

**基本信息**

- Title: Measuring the environmental impact of AI inference
- Author: Jeff Dean（Google DeepMind与Google Research首席科学家）
- Date: August 2025
- URL: https://cloud.google.com/blog/products/infrastructure/measuring-the-environmental-impact-of-ai-inference